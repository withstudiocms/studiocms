{"uid":"7fc872e8f1522969","name":"User Module - getUserData returns logged out session for expired session","fullName":"packages/@withstudiocms/auth-kit/test/modules/user.test.ts#@withstudiocms/auth-kit Package Tests User Module - getUserData returns logged out session for expired session","historyId":"b2c63464633aa78b3538df132897078c:d41d8cd98f00b204e9800998ecf8427e","time":{"start":1764224269824,"stop":1764224269827,"duration":3},"status":"broken","statusMessage":"Cannot read properties of undefined (reading 'expiresAt')","statusTrace":"TypeError: Cannot read properties of undefined (reading 'expiresAt')\n    at Object.next (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/session.ts:125:13)\n    at @withstudiocms/AuthKit/modules/session.validateSessionToken (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/session.ts:103:39)\n    at @withstudiocms/AuthKit/modules/session.validateSessionToken (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/user.ts:268:50)\n    at @withstudiocms/AuthKit/modules/user.getUserData (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/user.ts:257:30)\n    at @withstudiocms/AuthKit/modules/user.getUserData (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/test/modules/user.test.ts:311:43)","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"status":"broken","statusMessage":"Cannot read properties of undefined (reading 'expiresAt')","statusTrace":"TypeError: Cannot read properties of undefined (reading 'expiresAt')\n    at Object.next (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/session.ts:125:13)\n    at @withstudiocms/AuthKit/modules/session.validateSessionToken (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/session.ts:103:39)\n    at @withstudiocms/AuthKit/modules/session.validateSessionToken (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/user.ts:268:50)\n    at @withstudiocms/AuthKit/modules/user.getUserData (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/user.ts:257:30)\n    at @withstudiocms/AuthKit/modules/user.getUserData (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/test/modules/user.test.ts:311:43)","steps":[{"name":"Should return logged out session and delete cookie","time":{"start":1764224269825,"stop":1764224269827,"duration":2},"status":"broken","statusMessage":"Cannot read properties of undefined (reading 'expiresAt')","statusTrace":"TypeError: Cannot read properties of undefined (reading 'expiresAt')\n    at Object.next (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/session.ts:125:13)\n    at @withstudiocms/AuthKit/modules/session.validateSessionToken (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/session.ts:103:39)\n    at @withstudiocms/AuthKit/modules/session.validateSessionToken (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/user.ts:268:50)\n    at @withstudiocms/AuthKit/modules/user.getUserData (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/src/modules/user.ts:257:30)\n    at @withstudiocms/AuthKit/modules/user.getUserData (/home/runner/work/studiocms/studiocms/packages/@withstudiocms/auth-kit/test/modules/user.test.ts:311:43)","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"owner","value":"withstudiocms"},{"name":"lead","value":"Adam Matthiesen"},{"name":"framework","value":"Vitest"},{"name":"language","value":"TypeScript/JavaScript"},{"name":"framework","value":"vitest"},{"name":"language","value":"javascript"},{"name":"parentSuite","value":"@withstudiocms/auth-kit Package Tests"},{"name":"host","value":"runnervmg1sw1"},{"name":"thread","value":"vitest-worker-2"},{"name":"package","value":"packages.@withstudiocms.auth-kit.test.modules.user.test.ts"},{"name":"parentSuite","value":"@withstudiocms/auth-kit Package Tests"},{"name":"suite","value":"User Module Tests"},{"name":"subSuite","value":"getUserData Tests"},{"name":"tag","value":"package:@withstudiocms/auth-kit"},{"name":"tag","value":"type:unit"},{"name":"tag","value":"scope:withstudiocms"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","owner":"withstudiocms","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[]}],"history":{"statistic":{"failed":0,"broken":1,"skipped":0,"passed":3,"unknown":0,"total":4},"items":[{"uid":"13428b891431f0d3","reportUrl":"https://tests.studiocms.dev/allure-reports/adam_sdk-swap/studiocms-tests/19726244553_1764221679118/#testresult/13428b891431f0d3","status":"passed","time":{"start":1764221552440,"stop":1764221552442,"duration":2}},{"uid":"8fccc97536b91cb1","reportUrl":"https://tests.studiocms.dev/allure-reports/adam_sdk-swap/studiocms-tests/19726062572_1764221111160/#testresult/8fccc97536b91cb1","status":"passed","time":{"start":1764220988417,"stop":1764220988419,"duration":2}},{"uid":"8c4c593f8c2820a1","reportUrl":"https://tests.studiocms.dev/allure-reports/adam_sdk-swap/studiocms-tests/19725542192_1764219155453/#testresult/8c4c593f8c2820a1","status":"passed","time":{"start":1764219026346,"stop":1764219026348,"duration":2}}]},"tags":["package:@withstudiocms/auth-kit","type:unit","scope:withstudiocms"]},"source":"7fc872e8f1522969.json","parameterValues":[]}