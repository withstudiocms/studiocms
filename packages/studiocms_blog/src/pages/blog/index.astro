---
import config from '@studiocms/blog:config';
import { pages } from '@studiocms/blog:context';
import { PageList, RSSIcon } from '@studiocms:blog/components';
import { BlogLayout } from '@studiocms:blog/layouts';
import studioCMS_SDK from 'studiocms:sdk';
import { name } from '../../../package.json';

// Set the title and description
const { description: configDescription, blogIndex } = config;

const title: string = blogIndex?.title || 'Blog';
const description: string = configDescription || 'Blog Index';
const showRSSFeed: boolean = blogIndex?.showRSSFeed || true;

// Get all pages
const blogPageList = await studioCMS_SDK.GET.packagePages(name);

// Get the RSS feed URL
const rssPath = pages.get('/rss.xml');
---
<BlogLayout {title} description={description} >
    <main>
        <h1>{title} {showRSSFeed && rssPath && <a href={rssPath}><RSSIcon /></a>}</h1>
        <PageList {blogPageList} />
    </main>
</BlogLayout>

<style>
	main {
		width: 960px;
	}
</style>