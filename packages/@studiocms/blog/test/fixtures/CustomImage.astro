---
/// <reference types="astro/client" />
import { Image } from 'astro:assets';

interface Props {
	src: string;
	alt: string;
	width: number;
	height: number;
}

const { src, ...props } = Astro.props;

// Get the current configured image service
async function getImageSrc() {
	return src;
}

// check if the image source is an external URL
function inferSizeNeeded(url: string) {
	if (url.startsWith('https://') || url.startsWith('http://')) {
		return true;
	}
	return false;
}

// Get the current configured image service source URL
const currentSrcURL = await getImageSrc();

// Set the image properties
const imageProps = {
	src: currentSrcURL,
	inferSize: inferSizeNeeded(currentSrcURL),
	...props,
};
---

<Image loading={"lazy"} {...imageProps} />
