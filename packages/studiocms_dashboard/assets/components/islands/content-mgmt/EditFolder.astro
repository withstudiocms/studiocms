---
import { studioCMS_SDK_Cache } from 'studiocms:sdk/cache';
import { Button, Icon, Input, Select } from 'studiocms:ui/components';
import { parentFolderOptions } from './shared';

const urlParams = Astro.url.searchParams;
const editId = urlParams.get('folder') || '';

const { data: folderList } = await studioCMS_SDK_Cache.GET.folderList();

const currentFolder = folderList.find((folder) => folder.id === editId);
---
<div id="edit-folder-container">

    <form id="edit-folder-form">
    
        <Input 
            label="Folder Name" 
            name="folder-name" 
            defaultValue={currentFolder?.name || ''}
            isRequired 
            />
        
        <Select 
            label="Parent Folder" 
            name="parent-folder" 
            options={parentFolderOptions} 
            defaultValue={currentFolder?.parent || 'null'} 
            fullWidth 
            />
    
    </form>

</div>

<div class="delete-folder-container">
    <form id="delete-folder-form">
        <input type="hidden" name="folder-id" value={currentFolder?.id} />
        <Button color="danger" type="submit" size="sm">
            <Icon name="trash-20-solid" width={20} height={20} />
            Delete Folder
        </Button>
    </form>
</div>

<style>
    #edit-folder-container {
        height: 100%;
        width: 100%;
        min-width: 100%;
    }

    #edit-folder-form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        padding-top: .5rem;
    }

    .delete-folder-container {
        padding-top: 1rem;
    }
</style>