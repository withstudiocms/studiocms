<script>
  const codesWithDiff = document.querySelectorAll('.astro-code.diff');

  for (const code of codesWithDiff) {
    const linesInserted = code.getAttribute('data-lines-inserted');
    const linesDeleted = code.getAttribute('data-lines-deleted');

    if (!linesInserted && !linesDeleted) continue;

    const parsedInsertedLines = linesInserted?.split(',').map((line) => parseInt(line, 10)) || [];
    const parsedDeletedLines = linesDeleted?.split(',').map((line) => parseInt(line, 10)) || [];

    const codeLines = code.querySelectorAll('.line');

    codeLines.forEach((line, index) => {
      if (parsedInsertedLines.includes(index + 1)) {
        line.classList.add('diff', 'ins');
      }

      if (parsedDeletedLines.includes(index + 1)) {
        line.classList.add('diff', 'del');
      }
    });
  }
</script>
