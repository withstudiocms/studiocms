---
import { prerenderRoutes as pagePreRendered } from 'studiocms:mode';
import { Button, Divider, Input } from '@studiocms/ui/components';
import Icon from '@studiocms/ui/utils/Icon.astro';
// import { useTranslations } from 'studiocms:i18n';
import { Layout } from '../components';
import Create from '../components/islands/content-mgmt/Create.astro';
import Edit from '../components/islands/content-mgmt/Edit.astro';
import PageHeader from '../components/islands/content-mgmt/PageHeader.astro';
import PageList from '../components/islands/content-mgmt/PageList.astro';

const lang = 'en-us';
// const t = useTranslations(lang, '@studiocms/dashboard:index');
---

<Layout 
  title="Content Management"
  requiredPermission='editor'
  sidebar='double'
  {pagePreRendered}
  {lang}
  >

  <div slot="double-sidebar" class="inner-sidebar-container">
    <div class="sidebar-links-container">
      <div class="inner-sidebar-header">
        <Input name='search' placeholder='Search...' />
        <Button as="a" href="?create=new" variant="solid" color="primary" size='sm' class="add-button">
          <Icon name="plus" width={24} height={24} />
        </Button>
      </div>
      <Divider background={'background-step-2'}>Items</Divider>
      <div class="inner-sidebar-items">
        { pagePreRendered 
          ? <PageList server:defer />
          : <PageList />
        }
      </div>
    </div>
  </div>

  <div slot="header">
    <PageHeader server:defer title="Content Management" />
  </div>

  <div id="placeholder-info" class="placeholder-info">
    <p>Select a page or create a new one to get started!</p>
  </div>

  <Edit server:defer />
  <Create server:defer />

</Layout>

<style>
  .inner-sidebar-container {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    min-height: 100vh;
    height: 100%;
    padding: 1rem;
  }

  .inner-sidebar-header {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;

    & input {
      margin-right: 1rem;
      width: 95%;
    }
  }

  .add-button {
    width: 32px !important;
    height: 32px !important;

    padding: 0.25rem !important;
  }

  .inner-sidebar-items {
    display: flex;
    flex-direction: column;
    gap: .375rem;
    width: 100%;
    height: 100%;
  }

  input[name=search] {
    /* heroicons:magnifying-glass-16-solid */
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAndJREFUSEvFlUtoFEEQhv/qRVkvevARiM+DiOAjKooS0KCYg9EIigrGi3jzIBK8bNdsCIHt3mURET14EwQhugQRIxg8KMRHEIMGQUFyCCiBGFBE8LLsdLkTZsUkm52BZLGuXV3f/FX19xDqHFTn+vh/gO7u7sXJZPK0iFwAsAnASgBjRDTsnOsvFot9PT09LqoDVRVkMpnVSqkBAFtrFBgBcI6ZP9WCzAIYYxqI6B2AxvDiGxEZSCQS733f30lEbQD2hGcTzrnd6XR6fC7INICIUDabfQ6gBcAkgIvM/GDmZWvtKRG5RUQrAAwxc3MsgDGmlYieBslEdERrHbSpahhjjhLR4zC3Q2vdWy1xmgJr7X0AZwA8ZOYTUQO01vYDOEZE/Vrr43EAYwA2ALjMzDeiAMaYK0R0NWgnMzfEARQBLBKRNs/znkQBMplMu1LqEYAfzLw8DuALgLUAOpn5ehTAGNNJRNcAfGXmdXEAlRncYebzUQBr7d3ACwB6mbkjEvCP5N8i0ux53ocaW7SLiF4CWAKgnZmnNmpmzDJaNpsdKhtrX9kD35xzJ9Pp9OsqPthfdnkfgFXlLRpm5orxogG5XK7JOTcIYCkAR0Q3nXPBszBORGuIqElELgFQYbVJ3/cPdHV1fY6lIEgyxmwnomA71teYwysAGwEE6/ldKdWSSqU+RraoklAoFBKjo6NnlVKtIrIDwBYAPoBA3T2t9e18Pr+5VCoNhk/GTxE56HleoPZvzPt/kMvltjnnXgBYBuBXefCHtdZvK4R5A8KWBhv1LIRMaK0biUim3qmoXY97bq3dCyBw/wgzH1pQBbU+YsEUzAWpO+APfeLiGcjy+NMAAAAASUVORK5CYII=") !important;
    background-position: 6px 6px !important;
    background-repeat: no-repeat !important;
    padding: .5rem 20px .5rem 2rem !important;
  }

  .placeholder-info {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 40vh;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 30vh;
    z-index: -1;

    p {
      font-size: 1.25rem;
      color: hsl(var(--text-muted));
    }
  }
</style>
