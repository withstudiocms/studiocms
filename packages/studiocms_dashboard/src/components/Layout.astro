---
import { ClientRouter } from 'astro:transitions';
import { Button } from '@studiocms/ui/components';
import Icon from '@studiocms/ui/utils/Icon.astro';
import { BaseHead } from '../components';
import SingleSidebar from './SingleSidebar.astro';
import LoginChecker from './islands/LoginChecker.astro';

type Props = {
	title: string;
	description: string;
	sidebar?: boolean | 'single' | 'double';
	requiredPermission?: 'owner' | 'admin' | 'editor' | 'visitor' | 'unknown' | 'none';
};

const { title, description, requiredPermission = 'unknown', sidebar = 'single' } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" data-theme={'dark'}>
  <head>
    <BaseHead title={title} description={description} />
    <ClientRouter />
  </head>
  <body>
    { requiredPermission !== 'none' && <LoginChecker server:defer {requiredPermission} /> }
    { sidebar === 'single' && <SingleSidebar transition:persist transition:persist-props /> }
    <!-- { sidebar === 'double' && <DoubleSidebar transition:persist transition:persist-props /> } -->
    <main class="p-6 pt-10">
      { sidebar !== false && (
        <Button variant="outlined" color="primary" class="nav-toggle" id={'nav-toggle'}>
          <Icon name="bars-3" height={24} width={24} />
        </Button>
      )}
      <slot />
    </main>
  </body>
</html>
