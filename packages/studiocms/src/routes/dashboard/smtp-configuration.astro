---
import { useTranslations } from 'studiocms:i18n';
import { Button, Card, Icon } from 'studiocms:ui/components';
import PageHeader from '../../components/dashboard/PageHeader.astro';
import Layout from '../../layouts/dashboard/Layout.astro';

const lang = 'en-us';
const t = useTranslations(lang, '@studiocms/dashboard:smtp');
---

<Layout 
  title={t('title')}
  description={t('description')}
  requiredPermission='owner'
  {lang}
  >

  <div slot="header">
    <PageHeader title={t('header')}>
      <Button variant="solid" color="primary" size="sm" type="submit" form="smtp-config-form">
        <Icon slot="start-content" name="check-20-solid" width={20} height={20} />
        <t-smtp key="save-button">{t('save-button')}</t-smtp>
      </Button>
    </PageHeader>
  </div>

  <Card fullWidth>
    <div slot="header">
      <h2><t-smtp key="smtp-settings">{t('smtp-settings')}</t-smtp></h2>
    </div>

  </Card>

  <Card fullWidth>
    <div slot="header">
      <h2><t-smtp key="test-smtp">{t('test-smtp')}</t-smtp></h2>
    </div>

  </Card>

</Layout>

<script>
    import { 
        $i18n,
        $localeSettings,
        baseTranslation,
        defaultLang,
        documentUpdater,
        makeTranslation,
        pageHeaderUpdater,
    } from 'studiocms:i18n/client';

    const currentPage = '@studiocms/dashboard:smtp';

    let lang = defaultLang;

    const i18n = $i18n(currentPage, baseTranslation[currentPage]);

    $localeSettings.subscribe((locale) => {
        lang = locale || defaultLang;
    });
    
    i18n.subscribe(comp => {
      documentUpdater(comp, lang)
      pageHeaderUpdater(comp.header)
    });
    
    if (!customElements.get('t-smtp')) {
        customElements.define('t-smtp', makeTranslation(currentPage, i18n));
    }
</script>

<style>
    .form-content {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
    }

    @media screen and (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
        }
    }
</style>
