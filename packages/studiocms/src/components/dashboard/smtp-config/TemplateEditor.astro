---
import { Icon } from 'studiocms:ui/components';
import { Button } from 'studiocms:ui/components/button';

interface Props {
	templateKeys: string[];
	templates: Record<string, string>;
	defaultTemplates: Record<string, string>;
	t: (key: 'preview-button-title') => string;
}

const { templateKeys, templates, defaultTemplates, t } = Astro.props;

const templateSaveAPIEndpoint = Astro.locals.StudioCMS.routeMap.endpointLinks.templates;
---
<Button 
    id="template-preview-button" 
    variant="outlined"
    color="primary"
    size="sm" 
    title={t('preview-button-title')}
>
    <Icon 
        slot="start-content" 
        name="heroicons:document-magnifying-glass-20-solid" 
        width={20} 
        height={20} 
    />
</Button>
<div 
    id="template-editor" 
    data-current-selection="none" 
    data-templates={JSON.stringify(templates)}
    data-template-keys={JSON.stringify(templateKeys)}
    data-default-templates={JSON.stringify(defaultTemplates)}
    data-save-endpoint={templateSaveAPIEndpoint}
></div>

<script src="./template-editor.ts"></script>

<style is:global>
    #template-editor-card {
        padding: 0;

        .sui-card-body {
            height: 100%;
            padding: 0 !important;
            overflow: hidden !important;
            position: relative;
        }
    }
</style>

<style>
    #template-editor {
        width: 100%;
        height: 100%;
        min-width: 100%;
        min-height: 100%;
        background-color: var(--background-step-1);
        border-radius: var(--radius-md);
        overflow: hidden;
    }

    #template-preview-button {
        position: absolute;
        top: 0.5rem;
        right: 1.25rem;
        z-index: 10;
        padding: 0.5rem;
    }
</style>