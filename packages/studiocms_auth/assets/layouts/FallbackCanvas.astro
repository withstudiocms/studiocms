---
import { Image } from 'astro:assets';
import { validImages } from 'studiocms:auth/utils/validImages';
import studioCMS_SDK_Cache from 'studiocms:sdk/cache';
import StudioCMSLogoSVG from '../components/StudioCMSLogoSVG.astro';

// Get the site config
const {
	data: { loginPageBackground, loginPageCustomImage },
} = await studioCMS_SDK_Cache.GET.siteConfig();

const fallbackImageSrc =
	loginPageBackground === 'custom'
		? loginPageCustomImage
		: validImages.find((x) => x.name !== 'custom' && x.name === loginPageBackground)?.dark; // TODO: Adapt to theme
---

<div class="fallback-container">
    <StudioCMSLogoSVG
        class="static-logo"
    />
    {typeof fallbackImageSrc === 'string' && (
        <Image 
            src={fallbackImageSrc || ''}
            inferSize
            alt="A fallback image displaying because the interactive wallpaper couldn't be loaded."
            class={'fallback-image'}
            quality={100}
        />
    )}
    {typeof fallbackImageSrc !== 'string' && !!fallbackImageSrc && (
        <Image 
            src={fallbackImageSrc}
            alt="A fallback image displaying because the interactive wallpaper couldn't be loaded."
            class={'fallback-image'}
            quality={100}
        />
    )}
</div>